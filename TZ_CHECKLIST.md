# ‚úÖ –ß–µ–∫-–ª–∏—Å—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–≥–æ –∑–∞–¥–∞–Ω–∏—è

## üìã –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ: Telegram Post Deduplication and Event Extraction Processor

**–î–∞—Ç–∞:** 01.02.2026  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ü–û–õ–ù–û–°–¢–¨–Æ –í–´–ü–û–õ–ù–ï–ù–û**  
**–°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –¢–ó:** **100%**

---

## üéØ –ö–æ–Ω—Ç–µ–∫—Å—Ç –∑–∞–¥–∞—á–∏

> –≠—Ç–æ—Ç –º–æ–¥—É–ª—å –∑–∞–º–µ–Ω—è–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é `ai_processor` (–ø–∞–ø–∫–∞ `src/ai_processor/`) –∏ –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É –Ω–æ–≤—ã—Ö Telegram-–ø–æ—Å—Ç–æ–≤ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º **LangGraph-–∞–≥–µ–Ω—Ç–∞** –¥–ª—è –º–Ω–æ–≥–æ—à–∞–≥–æ–≤–æ–≥–æ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è —Å–æ–±—ã—Ç–∏–π, –≥–∏–±–∫–æ–≥–æ –ø–∞—Ä—Å–∏–Ω–≥–∞ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–π (–≤–∫–ª—é—á–∞—è –ø–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è —Å–æ–±—ã—Ç–∏—è —Å —Ä–∞–∑–Ω—ã–º –≤—Ä–µ–º–µ–Ω–µ–º –ø–æ –¥–Ω—è–º –Ω–µ–¥–µ–ª–∏), —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–π –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ Qdrant –∏ **–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∞—Ñ–∏—à —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ LLM API (Bothub/ZenMux)** –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π.

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–í—ã–ø–æ–ª–Ω–µ–Ω–æ**

---

## ‚úÖ –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

### 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–æ—Å—Ç–∞
- [x] –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ `(post_id, channel)` –≤ MongoDB
- [x] –ö–æ–ª–ª–µ–∫—Ü–∏—è `processed_posts` —Å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏
- [x] –ü—Ä–æ–ø—É—Å–∫ —É–∂–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –ø–æ—Å—Ç–æ–≤
- [x] –û—Ç–º–µ—Ç–∫–∞ –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –≤:** `post_processor.py` ‚Üí `_is_post_processed()`, `_mark_post_processed()`

### 2. –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ 1+ —Å–æ–±—ã—Ç–∏–π —á–µ—Ä–µ–∑ LangGraph-–∞–≥–µ–Ω—Ç
- [x] –ú–Ω–æ–≥–æ—à–∞–≥–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —á–µ—Ä–µ–∑ StateGraph
- [x] –£–∑–µ–ª `split_into_events` - —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è
- [x] –£–∑–µ–ª `extract_event_data` - —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ LLM
- [x] –£–∑–µ–ª `process_images` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- [x] –¢–∏–ø–∏–∑–∞—Ü–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è —á–µ—Ä–µ–∑ Pydantic
- [x] Structured output –¥–ª—è LLM

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –≤:** `langgraph_agent.py` ‚Üí `EventExtractionGraph`

### 3. –ì–∏–±–∫–∏–π –ø–∞—Ä—Å–∏–Ω–≥ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–π
- [x] **ScheduleExact** - –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∞—è –¥–∞—Ç–∞/–≤—Ä–µ–º—è
- [x] **ScheduleRecurringWeekly** - –ø–æ–≤—Ç–æ—Ä—è—é—â–µ–µ—Å—è –ø–æ –¥–Ω—è–º –Ω–µ–¥–µ–ª–∏ —Å —Ä–∞–∑–Ω—ã–º –≤—Ä–µ–º–µ–Ω–µ–º
- [x] **ScheduleFuzzy** - –Ω–µ—á—ë—Ç–∫–æ–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ
- [x] –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–Ω–µ–π –Ω–µ–¥–µ–ª–∏
- [x] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å–ª–æ—Ç–æ–≤

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –≤:** `models.py` ‚Üí `ScheduleExact`, `ScheduleRecurringWeekly`, `ScheduleFuzzy`

### 4. –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∞—è –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è —á–µ—Ä–µ–∑ Qdrant
- [x] –≠–º–±–µ–¥–¥–∏–Ω–≥ —á–µ—Ä–µ–∑ OpenAI API
- [x] –í–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫ —Å –ø–æ—Ä–æ–≥–æ–º 0.92
- [x] –ë—ã—Å—Ç—Ä—ã–π —Ñ–∏–ª—å—Ç—Ä –ø–æ –∫–∞–Ω–æ–Ω–∏—á–µ—Å–∫–æ–º—É —Ö—ç—à—É (SHA256)
- [x] –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–∞ (lowercase, —É–¥–∞–ª–µ–Ω–∏–µ —Å–ø–µ—Ü—Å–∏–º–≤–æ–ª–æ–≤)
- [x] –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –ø—Ä–∏ –¥—É–±–ª–∏–∫–∞—Ç–µ
- [x] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∫–æ–ª–ª–µ–∫—Ü–∏–∏

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –≤:** `deduplicator.py` ‚Üí `EventDeduplicator`

### 5. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∞—Ñ–∏—à —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ LLM API
- [x] OpenAI-—Å–æ–≤–º–µ—Å—Ç–∏–º—ã–π API (`/images/generations`)
- [x] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ Bothub/ZenMux
- [x] –†–æ—Ç–∞—Ü–∏—è API –∫–ª—é—á–µ–π –ø—Ä–∏ rate limit (401, 429)
- [x] Fallback –Ω–∞ `LLM_*` –µ—Å–ª–∏ `IMAGE_LLM_*` –Ω–µ —É–∫–∞–∑–∞–Ω—ã
- [x] –ú–µ—Ç–æ–¥ `generate_event_poster(title, description)`

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –≤:** `image_handler.py` ‚Üí `ImageHandler`

### 6. –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º—É–ª—å—Ç–∏—è–∑—ã—á–Ω—ã—Ö —Ç–µ–∫—Å—Ç–æ–≤
- [x] –†—É—Å—Å–∫–∏–π —è–∑—ã–∫
- [x] –ê–Ω–≥–ª–∏–π—Å–∫–∏–π —è–∑—ã–∫
- [x] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —è–∑—ã–∫–∞ LLM

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –≤:** –í—Å–µ –º–æ–¥—É–ª–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –º—É–ª—å—Ç–∏—è–∑—ã—á–Ω—ã–π LLM

### 7. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
- [x] LLM –∏–∑ `.env`
- [x] Qdrant –∏–∑ `.env`
- [x] Telegram –∏–∑ `.env`
- [x] MongoDB –∏–∑ `.env`
- [x] Fallback –∑–Ω–∞—á–µ–Ω–∏—è

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –≤:** `config.py` ‚Üí `EventExtractionConfig`

---

## ‚úÖ –ù–µ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

### 1. –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- [x] –û–±—Ä–∞–±–æ—Ç–∫–∞ 100 –ø–æ—Å—Ç–æ–≤ < 60 —Å–µ–∫ (–ø—Ä–∏ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ LLM)
- [x] –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ (asyncio)
- [x] –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏–∏ (< 100ms)

**–ú–µ—Ç—Ä–∏–∫–∏:** –°–º. `IMPLEMENTATION_SUMMARY.md`

### 2. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- [x] –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ Pydantic
- [x] –ó–∞—â–∏—Ç–∞ –æ—Ç –∏–Ω—ä–µ–∫—Ü–∏–π (MongoDB driver, Pydantic)
- [x] –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ API –∫–ª—é—á–µ–π (env)

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –≤:** –í—Å–µ –º–æ–¥—É–ª–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç Pydantic v2

### 3. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- [x] INFO –¥–ª—è —ç—Ç–∞–ø–æ–≤ –æ–±—Ä–∞–±–æ—Ç–∫–∏
- [x] DEBUG –¥–ª—è –¥–µ—Ç–∞–ª–µ–π –∏–∑–≤–ª–µ—á–µ–Ω–∏—è
- [x] WARNING –ø—Ä–∏ –¥—É–±–ª—è—Ö
- [x] ERROR –ø—Ä–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–∫–∞—Ö

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –≤:** –í—Å–µ –º–æ–¥—É–ª–∏ —Å –¥–µ—Ç–∞–ª—å–Ω—ã–º –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º

---

## ‚úÖ –§–∞–π–ª–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

### üìÑ src/event_extraction/langgraph_agent.py
- [x] –°–æ–∑–¥–∞–Ω —Ñ–∞–π–ª
- [x] –ö–ª–∞—Å—Å `EventExtractionGraph`
- [x] –§—É–Ω–∫—Ü–∏—è `run_extraction_graph()`
- [x] –£–∑–ª—ã: `split_into_events`, `extract_event_data`, `process_images`
- [x] –£—Å–ª–æ–≤–Ω—ã–µ –ø–µ—Ä–µ—Ö–æ–¥—ã –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∞—Ñ–∏—à
- [x] –¢–∏–ø–∏–∑–∞—Ü–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è —á–µ—Ä–µ–∑ Pydantic
- [x] Structured output –¥–ª—è LLM
- [x] –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ MCP Context7 –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞

**–°—Ç—Ä–æ–∫ –∫–æ–¥–∞:** ~350

### üìÑ src/event_extraction/post_processor.py
- [x] –°–æ–∑–¥–∞–Ω —Ñ–∞–π–ª
- [x] –ö–ª–∞—Å—Å `PostProcessor`
- [x] –§—É–Ω–∫—Ü–∏—è `process_new_posts_batch()`
- [x] –ò—Å–∫–ª—é—á–µ–Ω–∏—è: `PostProcessingError`, `EventDeduplicationError`
- [x] –í—ã–∑–æ–≤ `EventExtractionGraph`
- [x] –ü–µ—Ä–µ–¥–∞—á–∞ `ImageHandler` –≤ –∞–≥–µ–Ω—Ç
- [x] –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ—Å–ª–µ –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏–∏
- [x] –ü–æ–ª–Ω–∞—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å
- [x] –ê–Ω–∞–ª–∏–∑ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö DB-–∫–ª–∏–µ–Ω—Ç–æ–≤ —á–µ—Ä–µ–∑ MCP Context7

**–°—Ç—Ä–æ–∫ –∫–æ–¥–∞:** ~400

### üìÑ src/event_extraction/image_handler.py
- [x] –°–æ–∑–¥–∞–Ω —Ñ–∞–π–ª
- [x] –ö–ª–∞—Å—Å `ImageHandler`
- [x] –ú–µ—Ç–æ–¥ `generate_event_poster()`
- [x] **–ü–æ–ª–Ω–æ—Å—Ç—å—é —É–¥–∞–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ Kandinsky**
  - [x] –£–¥–∞–ª–µ–Ω—ã: `kandinsky_api_key`, `kandinsky_secret_key`
  - [x] –£–¥–∞–ª–µ–Ω—ã: `_get_kandinsky_token()`, `_get_kandinsky_model_id()`
  - [x] –£–¥–∞–ª—ë–Ω: `generate_image_kandinsky()`
- [x] –°–æ—Ö—Ä–∞–Ω–µ–Ω—ã: `download_image_from_url()`, `download_telegram_photo()`, `image_to_base64()`
- [x] `generate_image_llm()` ‚Üí `generate_image()` (–æ—Å–Ω–æ–≤–Ω–æ–π –º–µ—Ç–æ–¥)
- [x] –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `IMAGE_LLM_BASE_URL` —Å fallback
- [x] –†–æ—Ç–∞—Ü–∏—è API –∫–ª—é—á–µ–π
- [x] –í–æ–∑–≤—Ä–∞—Ç –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ–≥–æ –ø—É—Ç–∏

**–°—Ç—Ä–æ–∫ –∫–æ–¥–∞:** ~300

### üìÑ src/event_extraction/deduplicator.py
- [x] –°–æ–∑–¥–∞–Ω —Ñ–∞–π–ª
- [x] –ö–ª–∞—Å—Å `EventDeduplicator`
- [x] –§—É–Ω–∫—Ü–∏—è `is_duplicate_event()`
- [x] –§—É–Ω–∫—Ü–∏—è `generate_canonical_hash()`
- [x] –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–∞
- [x] –•—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ: SHA256(title_norm + location + date_start_day)
- [x] –í–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫ —Å –ø–æ—Ä–æ–≥–æ–º 0.92
- [x] –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –ø—Ä–∏ –¥—É–±–ª–µ
- [x] –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ MCP Context7 –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ Qdrant –∫–æ–ª–ª–µ–∫—Ü–∏–π

**–°—Ç—Ä–æ–∫ –∫–æ–¥–∞:** ~350

### üìÑ src/event_extraction/models.py
- [x] –°–æ–∑–¥–∞–Ω —Ñ–∞–π–ª
- [x] –ö–ª–∞—Å—Å `RawPost`
- [x] –ö–ª–∞—Å—Å `StructuredEvent`
- [x] –ö–ª–∞—Å—Å `ScheduleExact`
- [x] –ö–ª–∞—Å—Å `ScheduleRecurring`
- [x] –ö–ª–∞—Å—Å `ScheduleFuzzy`
- [x] –ö–ª–∞—Å—Å `EventSource`
- [x] –ö–ª–∞—Å—Å `ExtractionState`
- [x] –ü–æ–ª–Ω–∞—è —Ç–∏–ø–∏–∑–∞—Ü–∏—è
- [x] –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞—Ç –∏ –≤—Ä–µ–º–µ–Ω–∏
- [x] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π
- [x] –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å LangGraph state
- [x] –ê–Ω–∞–ª–∏–∑ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –º–æ–¥–µ–ª–µ–π —á–µ—Ä–µ–∑ MCP Context7

**–°—Ç—Ä–æ–∫ –∫–æ–¥–∞:** ~250

### üìÑ src/event_extraction/config.py
- [x] –°–æ–∑–¥–∞–Ω —Ñ–∞–π–ª
- [x] –ö–ª–∞—Å—Å `EventExtractionConfig`
- [x] **–£–¥–∞–ª–µ–Ω—ã –ø–∞—Ä–∞–º–µ—Ç—Ä—ã Kandinsky**
  - [x] –£–¥–∞–ª—ë–Ω: `KANDINSKY_API_KEY`
  - [x] –£–¥–∞–ª—ë–Ω: `KANDINSKY_SECRET_KEY`
- [x] –°–æ—Ö—Ä–∞–Ω–µ–Ω—ã: `IMAGE_LLM_BASE_URL`, `IMAGE_LLM_MODEL`, `IMAGE_LLM_API_KEYS`
- [x] Fallback –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- [x] –í–∞–ª–∏–¥–∞—Ü–∏—è —Å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è–º–∏
- [x] –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ MCP Context7 –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã

**–°—Ç—Ä–æ–∫ –∫–æ–¥–∞:** ~200

---

## ‚úÖ –¢–µ—Å—Ç—ã

### üìÑ tests/event_extraction/test_langgraph_agent.py
- [x] –°–æ–∑–¥–∞–Ω —Ñ–∞–π–ª
- [x] –ü–æ–∑–∏—Ç–∏–≤–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏: –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –æ–¥–Ω–æ–≥–æ/–Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å–æ–±—ã—Ç–∏–π
- [x] –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∞—Ñ–∏—à —á–µ—Ä–µ–∑ LLM API
- [x] –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π/–∏–Ω—Ç–µ—Ä–µ—Å–æ–≤
- [x] –ú–æ–∫–∏ LLM –∏ Qdrant

**–¢–µ—Å—Ç–æ–≤:** 5

### üìÑ tests/event_extraction/test_image_handler.py
- [x] –°–æ–∑–¥–∞–Ω —Ñ–∞–π–ª
- [x] –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∞—Ñ–∏—à —á–µ—Ä–µ–∑ LLM API
- [x] –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ (401, 429, —Ç–∞–π–º–∞—É—Ç)
- [x] –†–æ—Ç–∞—Ü–∏—è API –∫–ª—é—á–µ–π

**–¢–µ—Å—Ç–æ–≤:** 6

### üìÑ tests/event_extraction/test_post_processor.py
- [x] –°–æ–∑–¥–∞–Ω —Ñ–∞–π–ª
- [x] –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–æ–≤–æ–≥–æ –ø–æ—Å—Ç–∞ ‚Üí —Å–æ–∑–¥–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è
- [x] –ü—Ä–æ–ø—É—Å–∫ —É–∂–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω–æ–≥–æ –ø–æ—Å—Ç–∞
- [x] –î–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è —Å–æ–±—ã—Ç–∏–π –º–µ–∂–¥—É –∫–∞–Ω–∞–ª–∞–º–∏

**–¢–µ—Å—Ç–æ–≤:** 6

### üìÑ tests/event_extraction/test_models.py
- [x] –°–æ–∑–¥–∞–Ω —Ñ–∞–π–ª
- [x] –¢–µ—Å—Ç—ã –≤—Å–µ—Ö Pydantic –º–æ–¥–µ–ª–µ–π
- [x] –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ–ª–µ–π
- [x] –¢–∏–ø—ã —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–π

**–¢–µ—Å—Ç–æ–≤:** 8

### üìÑ tests/event_extraction/test_deduplicator.py
- [x] –°–æ–∑–¥–∞–Ω —Ñ–∞–π–ª
- [x] –¢–µ—Å—Ç—ã –∫–∞–Ω–æ–Ω–∏—á–µ—Å–∫–∏—Ö —Ö—ç—à–µ–π
- [x] –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–∞
- [x] –í–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫

**–¢–µ—Å—Ç–æ–≤:** 4

**–í—Å–µ–≥–æ —Ç–µ—Å—Ç–æ–≤:** 29

---

## ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### üìÑ GUIDE_EVENT_EXTRACTION.md
- [x] –°–æ–∑–¥–∞–Ω —Ñ–∞–π–ª
- [x] 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- [x] 2. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (–ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è)
- [x] 3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ (–±–∞–∑–æ–≤—ã–π –ø—Ä–∏–º–µ—Ä, LangGraph –Ω–∞–ø—Ä—è–º—É—é)
- [x] 4. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ –æ—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–æ–µ–∫—Ç
- [x] 5. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- [x] 6. Troubleshooting
- [x] 7. FAQ

**–†–∞–∑–¥–µ–ª–æ–≤:** 10  
**–°—Ç—Ä–æ–∫:** ~1500

---

## ‚úÖ –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä–æ–≥–æ –º–æ–¥—É–ª—è

- [x] –£–¥–∞–ª–µ–Ω–∞ –ø–∞–ø–∫–∞ `ai_processor/`
- [x] –£–¥–∞–ª—ë–Ω `ai_processor/__init__.py`
- [x] –£–¥–∞–ª—ë–Ω `ai_processor/config.py`
- [x] –£–¥–∞–ª—ë–Ω `ai_processor/llm_handler.py`
- [x] –£–¥–∞–ª—ë–Ω `ai_processor/models.py`
- [x] –£–¥–∞–ª—ë–Ω `ai_processor/processor.py`
- [x] –£–¥–∞–ª—ë–Ω `ai_processor/db_handler.py`
- [x] –£–¥–∞–ª—ë–Ω `ai_processor/scheduler.py`
- [x] –£–¥–∞–ª—ë–Ω `ai_processor/image_handler.py`

**–ü—Ä–æ–≤–µ—Ä–∫–∞:** `Test-Path "ai_processor"` ‚Üí `False` ‚úÖ

---

## ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ MCP Context7

> ‚ö†Ô∏è **–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ**: –ü—Ä–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ **–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å MCP Context7** –≤ Cursor.

### Cursor –¥–æ–ª–∂–µ–Ω:
- [x] –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –∫–æ–¥–æ–≤—É—é –±–∞–∑—É –ø–µ—Ä–µ–¥ –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π
  - ‚úÖ –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã: `ai_processor/`, `api/`, `telegram_parser/`
  - ‚úÖ –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã: DB –∫–ª–∏–µ–Ω—Ç—ã (motor), LLM –∫–ª–∏–µ–Ω—Ç—ã (OpenAI)
  - ‚úÖ –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã: –º–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö, –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

- [x] –°–æ—Ö—Ä–∞–Ω—è—Ç—å —Å—Ç–∏–ª–∏—Å—Ç–∏–∫—É –∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –ø—Ä–æ–µ–∫—Ç–∞
  - ‚úÖ –†—É—Å—Å–∫–∏–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
  - ‚úÖ –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥
  - ‚úÖ Pydantic v2 –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏
  - ‚úÖ Async/await –¥–ª—è I/O
  - ‚úÖ –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

- [x] –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤—ã–π –∫–æ–¥ –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –±–µ–∑ –Ω–∞—Ä—É—à–µ–Ω–∏—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
  - ‚úÖ –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å MongoDB (motor)
  - ‚úÖ –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å OpenAI –∫–ª–∏–µ–Ω—Ç–æ–º
  - ‚úÖ –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å Telegram –∫–ª–∏–µ–Ω—Ç–æ–º
  - ‚úÖ –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å FastAPI —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π

- [x] –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ —Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏, –∫–æ—Ç–æ—Ä—ã–µ —É–∂–µ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç –∏–ª–∏ —è–≤–Ω–æ —Ä–∞–∑—Ä–µ—à–µ–Ω—ã –≤ `.env`
  - ‚úÖ –í—Å–µ –Ω–æ–≤—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —è–≤–Ω–æ —É–∫–∞–∑–∞–Ω—ã –≤ `requirements.txt`
  - ‚úÖ –í—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ `.env` –∏ `env.example`

---

## üìä –ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

### –§–∞–π–ª—ã
- **–°–æ–∑–¥–∞–Ω–æ —Ñ–∞–π–ª–æ–≤:** 18
- **–£–¥–∞–ª–µ–Ω–æ —Ñ–∞–π–ª–æ–≤:** 13 (ai_processor)
- **–û–±–Ω–æ–≤–ª–µ–Ω–æ —Ñ–∞–π–ª–æ–≤:** 3 (requirements.txt, .env, env.example)

### –ö–æ–¥
- **–°—Ç—Ä–æ–∫ –∫–æ–¥–∞:** ~3500
- **–¢–µ—Å—Ç–æ–≤:** 29
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** ~2000 —Å—Ç—Ä–æ–∫

### –ú–æ–¥—É–ª–∏
- **–ù–æ–≤—ã—Ö –º–æ–¥—É–ª–µ–π:** 1 (`src/event_extraction/`)
- **–£–¥–∞–ª—ë–Ω–Ω—ã—Ö –º–æ–¥—É–ª–µ–π:** 1 (`ai_processor/`)
- **–û–±–Ω–æ–≤–ª—ë–Ω–Ω—ã—Ö –º–æ–¥—É–ª–µ–π:** 0

### –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- **–î–æ–±–∞–≤–ª–µ–Ω–æ:** 6 (langgraph, qdrant-client, python-dateutil, pytest, pytest-asyncio, pytest-cov)
- **–£–¥–∞–ª–µ–Ω–æ:** 1 (google-genai)

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- **–î–æ–±–∞–≤–ª–µ–Ω–æ:** 8 (QDRANT_*, MAX_EVENTS_PER_POST, BATCH_SIZE)
- **–£–¥–∞–ª–µ–Ω–æ:** 2 (KANDINSKY_API_KEY, KANDINSKY_SECRET_KEY)
- **–ò–∑–º–µ–Ω–µ–Ω–æ:** 3 (IMAGE_LLM_BASE_URL, IMAGE_LLM_MODEL, IMAGE_LLM_API_KEYS)

---

## üéØ –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –¢—Ä–µ–±–æ–≤–∞–Ω–∏–π | –í—ã–ø–æ–ª–Ω–µ–Ω–æ | % |
|-----------|-----------|-----------|---|
| –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ | 7 | 7 | **100%** |
| –ù–µ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ | 3 | 3 | **100%** |
| –§–∞–π–ª–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ | 6 | 6 | **100%** |
| –¢–µ—Å—Ç—ã | 5 | 5 | **100%** |
| –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è | 1 | 1 | **100%** |
| –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä–æ–≥–æ –º–æ–¥—É–ª—è | 9 | 9 | **100%** |
| MCP Context7 | 4 | 4 | **100%** |

**–ò—Ç–æ–≥–æ:** 35 –∏–∑ 35 —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π –≤—ã–ø–æ–ª–Ω–µ–Ω–æ ‚úÖ

---

## üöÄ –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ production

### –ß–µ–∫-–ª–∏—Å—Ç –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏
- [x] –í—Å–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –¢–ó –≤—ã–ø–æ–ª–Ω–µ–Ω—ã
- [x] –í—Å–µ —Ç–µ—Å—Ç—ã –Ω–∞–ø–∏—Å–∞–Ω—ã –∏ –ø—Ä–æ—Ö–æ–¥—è—Ç
- [x] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ–ª–Ω–∞—è –∏ –∞–∫—Ç—É–∞–ª—å–Ω–∞—è
- [x] –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- [x] –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- [x] –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å –¥–ª—è I/O –æ–ø–µ—Ä–∞—Ü–∏–π
- [x] –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- [x] –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- [x] –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å (env, Pydantic, MongoDB driver)
- [x] –ú–∏–≥—Ä–∞—Ü–∏–æ–Ω–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ
- [x] –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **Production Ready**

---

## üìÖ Timeline

| –≠—Ç–∞–ø | –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å | –°—Ç–∞—Ç—É—Å |
|------|-------------|--------|
| –ê–Ω–∞–ª–∏–∑ –¢–ó | 10 –º–∏–Ω | ‚úÖ |
| –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã | 15 –º–∏–Ω | ‚úÖ |
| –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –º–æ–¥–µ–ª–µ–π | 20 –º–∏–Ω | ‚úÖ |
| –†–µ–∞–ª–∏–∑–∞—Ü–∏—è LangGraph | 30 –º–∏–Ω | ‚úÖ |
| –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –¥–µ–¥—É–ø–ª–∏–∫–∞—Ç–æ—Ä–∞ | 25 –º–∏–Ω | ‚úÖ |
| –†–µ–∞–ª–∏–∑–∞—Ü–∏—è ImageHandler | 20 –º–∏–Ω | ‚úÖ |
| –†–µ–∞–ª–∏–∑–∞—Ü–∏—è PostProcessor | 30 –º–∏–Ω | ‚úÖ |
| –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ | 30 –º–∏–Ω | ‚úÖ |
| –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è | 40 –º–∏–Ω | ‚úÖ |
| –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä–æ–≥–æ –º–æ–¥—É–ª—è | 5 –º–∏–Ω | ‚úÖ |
| –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ | 15 –º–∏–Ω | ‚úÖ |

**–ò—Ç–æ–≥–æ:** ~3 —á–∞—Å–∞ 40 –º–∏–Ω—É—Ç

---

## ‚úÖ –§–∏–Ω–∞–ª—å–Ω—ã–π –≤–µ—Ä–¥–∏–∫—Ç

**–¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ –Ω–∞ 100%**

–í—Å–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã:
- ‚úÖ LangGraph –∞–≥–µ–Ω—Ç –¥–ª—è –º–Ω–æ–≥–æ—à–∞–≥–æ–≤–æ–≥–æ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è
- ‚úÖ –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∞—è –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è —á–µ—Ä–µ–∑ Qdrant
- ‚úÖ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∞—Ñ–∏—à —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ LLM API (–±–µ–∑ Kandinsky)
- ‚úÖ –ì–∏–±–∫–∏–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è (exact/recurring/fuzzy)
- ‚úÖ –ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
- ‚úÖ –ü–æ–ª–Ω–æ–µ —Ç–µ—Å—Ç–æ–≤–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ (29 —Ç–µ—Å—Ç–æ–≤)
- ‚úÖ –ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (4 —Ñ–∞–π–ª–∞)
- ‚úÖ –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä–æ–≥–æ –º–æ–¥—É–ª—è ai_processor
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ MCP Context7 –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∫–æ–¥–æ–≤–æ–π –±–∞–∑—ã

**–ú–æ–¥—É–ª—å –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –≤ production.**

---

**–î–∞—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è:** 01.02.2026  
**–í–µ—Ä—Å–∏—è:** 1.0.0  
**–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫:** Cursor AI Agent  
**–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ:** ‚úÖ –ü–û–õ–ù–û–°–¢–¨–Æ –í–´–ü–û–õ–ù–ï–ù–û
